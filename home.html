<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Free Snake Relocation ‚Äì Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    body{font-family:'Inter',sans-serif;background:#f5f9f5;color:#333;margin:0;line-height:1.7;font-size:1rem}
    .banner{background:#225533;color:#fff;padding:20px;text-align:center;font-size:1.5rem;font-weight:600}
    .content-wrapper{max-width:1000px;margin:0 auto;padding:20px}
    .hero{background:#e6f5ea;padding:50px 20px;border-radius:12px;text-align:center;margin-bottom:32px}
    .hero h1{color:#225533;font-size:2.2rem;margin:0 0 12px}
    .hero p{font-size:1.1rem;margin:0 0 20px;color:#444}
    .hero a button{padding:14px 18px;background:#225533;color:#fff;border:0;border-radius:6px;font-size:1.05rem;font-weight:600;cursor:pointer;box-shadow:0 4px 6px rgba(0,0,0,.1);transition:background .2s,transform .2s;margin:5px}
    .hero a button:hover{background:#1a3e28;transform:scale(1.03)}
    .section{margin:26px 0}
    .section:nth-child(even){background:#f0f7f0;padding:20px;border-radius:10px}
    .section h2{color:#225533;font-size:1.4rem;margin:0 0 10px;display:flex;align-items:center;gap:10px}
    .section p{font-size:1rem;color:#444}
    blockquote{border-left:4px solid #225533;padding-left:15px;margin:16px 0;color:#555;font-style:italic}
    a{color:#225533;font-weight:600;text-decoration:none}
    a:hover{text-decoration:underline}
    footer{text-align:center;font-size:.9rem;color:#777;margin:40px 0 20px}

    /* Finder block */
    .finder-card{background:#fff;border:1px solid #dfe7df;border-radius:12px;padding:16px;box-shadow:0 2px 6px rgba(0,0,0,.05)}
    .finder-actions{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
    .finder-actions input{flex:1;min-width:240px;padding:10px;border:1px solid #dfe7df;border-radius:8px}
    .btn{appearance:none;display:inline-block;background:#e9efe9;border:1px solid #dfe7df;border-radius:8px;padding:10px 14px;cursor:pointer}
    .btn-primary{background:#225533;color:#fff;border-color:#225533}
    .results-grid{display:grid;gap:10px}
    .card{background:#fff;border:1px solid #dfe7df;border-radius:10px;padding:12px}
    .helper{color:#667;font-size:.95rem}
    .hr{height:1px;background:#dfe7df;margin:14px 0}
    .contact-line{margin-top:6px;font-weight:600}
    .text-note{font-size:.9rem;color:#395; margin-top:2px}
    @media (max-width:600px){.hero h1{font-size:1.8rem}.hero p{font-size:1rem}.hero a button{width:100%}}
  </style>
</head>
<body>

  <div class="banner">Free Snake Relocation</div>

  <div class="content-wrapper">

    <!-- HERO -->
    <div class="hero">
      <h1>Welcome to Free Snake Relocation</h1>
      <p>Connecting you with experienced volunteers to safely remove snakes from your property ‚Äî completely free.</p>
      <a href="/find.html"><button>üîç Find a Relocator</button></a>
      <a href="/reviews.html"><button>üí¨ Read Reviews</button></a>
      <a href="https://docs.google.com/forms/d/e/1FAIpQLSfOs7QDb7rV7ckkaOIEPRNO0dYtNRorzYTw4sYi-sXTKDe6OA/viewform" target="_blank">
        <button>üìù Leave a Review</button>
      </a>
    </div>

    <!-- GPS / Address Finder -->
    <div class="section">
      <div class="finder-card" aria-labelledby="closest-title">
        <h2 id="closest-title">Relocators Near You</h2>
        <p class="helper">Click Find to use your location, or type an address and click Search by address. We‚Äôll show the three closest volunteers with distance.</p>

        <div class="finder-actions">
          <button id="btnGeoFind" class="btn btn-primary">Find (use my location)</button>
          <input id="addrInput" type="text" placeholder="Or enter an address, city, or ZIP" />
          <button id="btnAddrFind" class="btn">Search by address</button>
        </div>

        <div id="closestNotice" class="helper" style="margin:6px 0 12px;"></div>

        <!-- Global text-first hint -->
        <div class="text-note" style="margin-bottom:10px;">
          Text first if possible. Many volunteers won‚Äôt answer unknown calls.
          Include your name, city, a GPS pin, and a brief description (inside/under porch/garage, etc.).
        </div>

        <div id="closestResults" class="results-grid"></div>

        <div class="hr"></div>
        <div class="helper">
          Tip: Share a GPS pin, where the snake is, and any access notes so the volunteer can plan safely.
        </div>
      </div>
    </div>

    <!-- Your existing sections -->
    <div class="section">
      <h2>üêç How It Works</h2>
      <p>We connect people with volunteer snake relocators in their area. Use our tools to search by city/state or browse the interactive map.</p>
    </div>

    <div class="section">
      <h2>ü§ù Become a Volunteer</h2>
      <p>If you have experience handling snakes and want to help your community, <a href="/volunteer.html">sign up here</a>.</p>
    </div>

    <div class="section">
      <h2>üìö Learn About Snakes</h2>
      <p>Visit our <a href="/education.html">Education Section</a> to learn about snakes by state and how to coexist safely with them.</p>
    </div>

    <div class="section">
      <h2>üí¨ What People Are Saying</h2>
      <blockquote>
        ‚ÄúThanks to this site, a volunteer came within 30 minutes and safely removed the snake from my backyard. Amazing work!‚Äù ‚Äì Maria R., Florida
      </blockquote>
      <p>
        <a href="/reviews.html">Read more reviews</a> ¬∑
        <a href="https://docs.google.com/forms/d/e/1FAIpQLSfOs7QDb7rV7ckkaOIEPRNO0dYtNRorzYTw4sYi-sXTKDe6OA/viewform" target="_blank">Leave a review</a>
      </p>
    </div>

    <div class="section" style="font-size:.95rem;">
      üîß Found an issue or bad listing? <a href="/Contact.html">Let us know here.</a>
    </div>

    <footer>¬© 2025 Free Snake Relocation ¬∑ Volunteer-run ¬∑ <a href="/disclaimer.html">Disclaimer</a></footer>
  </div>

  <!-- Finder logic -->
  <script>
    // ====== CONFIG ======
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyYvJrlkMEfP3EfuySAo9mHXNLl75expJZG9aj69oN4MeGdBvnPp0dHKS7kWGzVH3YK2A/exec';
    const TOP_N = 3;

    // Elements
    const btnGeo  = document.getElementById('btnGeoFind');
    const btnAddr = document.getElementById('btnAddrFind');
    const addrEl  = document.getElementById('addrInput');
    const notice  = document.getElementById('closestNotice');
    const results = document.getElementById('closestResults');

    btnGeo?.addEventListener('click', () => {
      clearUI();
      notice.textContent = 'Getting your location...';
      if (!('geolocation' in navigator)) { notice.textContent = 'Geolocation not supported by this browser.'; return; }
      navigator.geolocation.getCurrentPosition(async (pos) => {
        const { latitude, longitude } = pos.coords;
        notice.textContent = 'Finding closest volunteers...';
        try {
          const res = await fetch(`${SCRIPT_URL}?lat=${latitude}&lon=${longitude}&limit=${TOP_N}`, { cache: 'no-store' });
          await renderResults(res);
        } catch (e) { showError(e); }
      }, () => { notice.textContent = 'Location permission denied. You can search by address instead.'; }, { enableHighAccuracy:true, timeout:12000, maximumAge:0 });
    });

    btnAddr?.addEventListener('click', async () => {
      clearUI();
      const a = (addrEl.value || '').trim();
      if (!a) { notice.textContent = 'Please type an address, city, or ZIP.'; return; }
      notice.textContent = 'Finding closest volunteers...';
      try {
        const res = await fetch(`${SCRIPT_URL}?address=${encodeURIComponent(a)}&limit=${TOP_N}`, { cache: 'no-store' });
        await renderResults(res);
      } catch (e) { showError(e); }
    });

    async function renderResults(res) {
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const ct = (res.headers.get('content-type') || '').toLowerCase();
      const text = await res.text();
      const rows = ct.includes('application/json') ? JSON.parse(text) : JSON.parse(text);

      if (!Array.isArray(rows) || rows.length === 0) {
        notice.textContent = 'No volunteers found near that location.';
        return;
      }
      notice.textContent = `Showing the ${Math.min(rows.length, TOP_N)} closest volunteers:`;
      results.innerHTML = rows.map(renderCard).join('');
    }

    function renderCard(r) {
      const name  = esc(r['Full Name'] || 'Name N/A');
      const phone = esc(r['Phone'] || '');
      const email = esc(r['Email'] || '');
      const city  = esc(r['City'] || '');
      const state = esc(r['State'] || '');
      const miles = typeof r['Distance'] === 'number' ? `${Number(r['Distance']).toFixed(1)} mi` : '';
      const notes = esc(r['Notes'] || '');

      const emailHref = email ? `href="mailto:${email}"` : '';

      return `
        <div class="card">
          <div style="display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap">
            <div>
              <strong>${name}</strong> ${miles ? `<span class="helper">‚Ä¢ ${miles}</span>` : ''}
              <div class="helper">${city}${city && state ? ', ' : ''}${state}</div>
              ${notes ? `<div class="helper">Notes: ${notes}</div>` : ''}
              ${phone ? `<div class="contact-line">Phone: ${phone}</div>
                         <div class="text-note">Prefer text first (many volunteers screen calls).</div>` : ''}
            </div>
            <div style="display:flex;gap:8px;align-items:center">
              ${emailHref ? `<a class="btn" ${emailHref}>Email</a>` : ''}
            </div>
          </div>
        </div>
      `;
    }

    function clearUI(){ results.innerHTML=''; notice.textContent=''; }
    function showError(e){ notice.textContent='Could not load results. Try again.'; console.error(e); }
    function esc(s){ return String(s||'').replace(/[&<>"']/g,m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;' }[m])); }
  </script>
</body>
</html>
